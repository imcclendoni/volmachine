---
# Options Volatility Trading Engine - Global Settings
# ====================================================

# Account Configuration
account:
  equity: 10000  # Paper trading equity - ADJUST TO YOUR ACTUAL AMOUNT
  timezone: "America/Chicago"

# Market Parameters
market:
  risk_free_rate: 0.045  # 4.5% risk-free rate (update periodically)
  strike_tolerance: 0.01  # Strike matching tolerance (0.01 = 1 cent)
  
  # Default dividend yields by symbol (annualized continuous yield)
  dividend_yields:
    SPY: 0.013   # ~1.3% yield
    QQQ: 0.005   # ~0.5% yield
    IWM: 0.011   # ~1.1% yield
    default: 0.0  # Default for unknown symbols

# Data Provider Configuration
data:
  provider: "polygon"  # Options: polygon, tradier, ibkr
  polygon:
    api_key: "${POLYGON_API_KEY}"  # Set via environment variable
    base_url: "https://api.polygon.io"
  tradier:
    api_key: "${TRADIER_API_KEY}"
    base_url: "https://api.tradier.com"
    sandbox: true
  ibkr:
    host: "127.0.0.1"
    port: 7497
    client_id: 1

# Cache Configuration
cache:
  enabled: true
  backend: "parquet"  # Options: parquet, duckdb
  directory: "./cache"
  ttl_hours: 24  # Cache TTL for option chains

# Risk Management (Non-negotiable)
risk:
  # Per-trade risk
  max_risk_per_trade_pct: 1.0  # Max 1% of equity per trade
  
  # Portfolio-level risk
  max_total_risk_pct: 10.0  # Max total portfolio risk (sum of max losses)
  max_trades_open: 10
  
  # Loss limits
  daily_loss_limit_pct: 3.0
  weekly_loss_limit_pct: 5.0
  max_drawdown_pct: 15.0  # Kill switch - stop all trading
  
  # Stress test parameters
  stress:
    gap_scenarios: [0.02, 0.05]  # ±2%, ±5% gaps
    iv_shift_points: 5  # ±5 vol points
    spread_widen_factor: 2.0  # Bid-ask doubles

# Regime Engine Settings
regime:
  # Moving average periods for trend
  ma_periods: [20, 50, 200]
  
  # Realized volatility windows
  rv_windows: [5, 20, 60]
  
  # VIX thresholds
  vix_low: 15
  vix_high: 25
  vix_panic: 35
  
  # Update frequency
  update_frequency: "daily"  # Options: daily, intraday

# Edge Detection Thresholds
edges:
  # Volatility Risk Premium
  vrp:
    iv_rv_ratio_threshold: 1.3  # Signal when IV/RV > 1.3
    lookback_days: 252
    percentile_threshold: 80  # Top 20% of historical readings
  
  # Term Structure
  term_structure:
    contango_threshold: 0.02  # 2% front < back
    backwardation_threshold: -0.02  # 2% front > back
  
  # Skew
  skew:
    lookback_days: 60
    percentile_extreme: 90  # Top/bottom 10%
  
  # Event Volatility
  event_vol:
    min_iv_premium_pct: 20  # Min 20% IV premium to trigger
    days_before_event: 5
    crush_lookback: 8  # Historical events to analyze
  
  # Gamma Pressure
  gamma:
    pin_zone_width_pct: 1.0  # ±1% around pin
    flip_threshold: 0.0  # Negative = short gamma dominant

# Trade Structure Settings
structures:
  # Liquidity filters
  liquidity:
    min_volume: 100
    min_open_interest: 500
    max_bid_ask_width_pct: 5.0  # Max 5% bid-ask spread
    
  # Live mode requires strict liquidity  
  enforce_liquidity: true  # Set false for paper/backtest
  
  # Expiry preferences
  expiry:
    min_dte: 7
    max_dte: 60
    preferred_dte: [21, 30, 45]  # Target DTE range
  
  # Strike width preferences
  strikes:
    preferred_width: 5  # Default $5 width
    min_width: 1
    max_width: 20
    credit_spread_width: 5  # $5 wide credit spreads
    iron_condor_wing_width: 10
    butterfly_wing_width: 5

# Paper Trading Settings
paper:
  enabled: true
  slippage_pct: 0.5  # 0.5% slippage on fills
  fill_at: "conservative"  # Options: mid, bid, ask, conservative

# Logging Configuration
logging:
  level: "INFO"
  json_logs: true
  log_directory: "./logs"
  
# Reporting
reporting:
  output_directory: "./logs/reports"
  format: ["markdown", "html"]
