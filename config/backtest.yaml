# Backtest Configuration v3
# With symbol gates, strategy toggles, and refined exit rules

# ============================================================
# SLIPPAGE & COMMISSIONS
# ============================================================

slippage:
  per_leg: 0.02

commissions:
  per_contract: 0.65
  min_per_order: 0.00
  reg_fee_per_contract: 0.02

# ============================================================
# STRATEGY TOGGLES
# ============================================================

strategies:
  skew_extreme:
    # Enable/disable sub-strategies
    enable_credit_spread: true   # STEEP signals -> credit spreads
    enable_debit_spread: false   # FLAT signals -> debit spreads (disabled - 11% win)
    
    # Symbol gate - which symbols are allowed for this edge
    enabled_symbols: ["SPY", "QQQ", "IWM"]  # TLT excluded (0% win)
    disabled_symbols: ["TLT"]
    
    # Minimum edge strength (0.5 = 50%)
    min_strength: 0.50

# ============================================================
# EXIT RULES - STRUCTURE SPECIFIC
# ============================================================

exit_rules:
  credit_spread:
    # Take profit at X% of credit received
    take_profit_pct: 50
    # Stop loss at Yx credit (1.5x = tighter risk management)
    stop_loss_mult: 1.5
    # Time stop: exit at 50% of initial DTE OR when DTE <= 7
    time_stop_dte: 7
    time_stop_pct_of_dte: 50  # Exit when half the time has passed
    # Max hold days (0 = use DTE stops only)
    max_hold_days: 0
  
  debit_spread:
    # Take profit at X% of max profit (spread width - debit)
    take_profit_pct: 50
    # OR take profit at 100% of debit paid (double your money)
    take_profit_debit_mult: 1.0
    # Stop loss at X% of debit paid
    stop_loss_pct: 50
    # Time stop: exit if DTE <= X
    time_stop_dte: 10
    # Max hold days
    max_hold_days: 0

# ============================================================
# DEFAULTS
# ============================================================

defaults:
  lookback_days: 90
  min_edge_strength: 0.50
  trade_only: true
  # Default universe (can be overridden by strategy-specific gates)
  symbols: ["SPY", "QQQ", "IWM", "TLT"]

# ============================================================
# VALIDATION
# ============================================================

validation:
  require_history_mode: true
  min_history_days: 20
  fail_on_fallback: true
